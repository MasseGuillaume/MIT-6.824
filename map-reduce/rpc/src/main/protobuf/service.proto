syntax = "proto3";

package grpc;


option java_multiple_files = true;
option java_package = "grpc";

import "google/protobuf/empty.proto";


service Worker {
  rpc Map (MapRequest) returns (MapResponse);
  rpc MapDone (google.protobuf.Empty) returns (MapResponse);

  rpc ReadIntermediateFile (IntermediateFile) returns (IntermediateFileContent);
  rpc Reduce (ReduceRequest) returns (ReduceResponse);
}

message DistributedFile {
  string filename = 1;
}

message MapRequest {
  repeated DistributedFile inputFiles = 1;
}

message MapResponse {
  repeated IntermediateFile results = 1;
}

message IntermediateFile {
  string filename = 1;
}

message IntermediateFileContent {
  string content = 1;
}

message ReduceRequest {
  string key = 1;
}

message ReduceResponse {
  repeated DistributedFile outputFiles = 1;
}